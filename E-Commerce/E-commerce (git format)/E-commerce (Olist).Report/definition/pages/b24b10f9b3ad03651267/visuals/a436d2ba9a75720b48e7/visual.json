{
  "$schema": "https://developer.microsoft.com/json-schemas/fabric/item/report/definition/visualContainer/2.1.0/schema.json",
  "name": "a436d2ba9a75720b48e7",
  "position": {
    "x": 752.27272727272725,
    "y": 60.227272727272727,
    "z": 3000,
    "height": 276.13636363636363,
    "width": 502.27272727272725,
    "tabOrder": 2000
  },
  "visual": {
    "visualType": "pythonVisual",
    "query": {
      "queryState": {
        "Values": {
          "projections": [
            {
              "field": {
                "Column": {
                  "Expression": {
                    "SourceRef": {
                      "Entity": "e-commerce order_reviews"
                    }
                  },
                  "Property": "review_score"
                }
              },
              "queryRef": "e-commerce order_reviews.review_score",
              "nativeQueryRef": "review_score"
            },
            {
              "field": {
                "Column": {
                  "Expression": {
                    "SourceRef": {
                      "Entity": "e-commerce order_reviews"
                    }
                  },
                  "Property": "review_comment_message"
                }
              },
              "queryRef": "e-commerce order_reviews.review_comment_message",
              "nativeQueryRef": "review_comment_message"
            },
            {
              "field": {
                "Column": {
                  "Expression": {
                    "SourceRef": {
                      "Entity": "e-commerce order_reviews"
                    }
                  },
                  "Property": "order_id"
                }
              },
              "queryRef": "e-commerce order_reviews.order_id",
              "nativeQueryRef": "order_id"
            }
          ]
        }
      }
    },
    "objects": {
      "script": [
        {
          "properties": {
            "source": {
              "expr": {
                "Literal": {
                  "Value": "'# Duplicate rows will be removed from the data.\n# The following code to create a dataframe and remove duplicate rows is always executed and acts as a preamble for your script:\n# dataset = pandas.DataFrame(review_score, review_comment_message, order_id)\n# dataset = dataset.drop_duplicates()\n\n# Paste or type your script code here:\n\n# 1. Filter the dataset for negative reviews (scores 1 and 2)\nnegative_reviews_df = dataset[dataset[''review_score''].isin([1, 2])]\n\n# 2. Combine all negative review comments into one single string\n# Using .fillna('''') to handle potential missing (NaN) comment messages gracefully\nnegative_comments_text = '' ''.join(negative_reviews_df[''review_comment_message''].fillna('''').astype(str))\n\n# 3. Create and generate the WordCloud\nfrom wordcloud import WordCloud\nimport matplotlib.pyplot as plt\n\nwordcloud = WordCloud(\n    width=1500, \n    height=800, \n    background_color=''white'',\n    # Note: ''generate()'' automatically handles text tokenization and counting\n).generate(negative_comments_text)\n\n# 4. Display the WordCloud\n\n# REMOVED: plt.figure(figsize=(15, 8)) -- Removing fixed figsize allows the plot to adapt to Power BI container size.\n# Power BI automatically creates the figure.\n\n# The subplots_adjust is often sufficient, but tight_layout is a good safeguard.\nplt.subplots_adjust(left=0, right=1, top=1, bottom=0)\n\nplt.imshow(wordcloud, interpolation=\"bilinear\")\nplt.axis(\"off\")\n\n# CRITICAL FIX: Use tight_layout() to automatically adjust subplot params for a tight layout\n# This minimizes whitespace around the plot content.\nplt.tight_layout(pad=0) \n\nplt.show() \n'"
                }
              }
            },
            "provider": {
              "expr": {
                "Literal": {
                  "Value": "'Python'"
                }
              }
            }
          }
        }
      ]
    },
    "visualContainerObjects": {
      "title": [
        {
          "properties": {
            "fontFamily": {
              "expr": {
                "Literal": {
                  "Value": "'Arial'"
                }
              }
            },
            "fontSize": {
              "expr": {
                "Literal": {
                  "Value": "12D"
                }
              }
            },
            "bold": {
              "expr": {
                "Literal": {
                  "Value": "true"
                }
              }
            },
            "alignment": {
              "expr": {
                "Literal": {
                  "Value": "'center'"
                }
              }
            },
            "fontColor": {
              "solid": {
                "color": {
                  "expr": {
                    "ThemeDataColor": {
                      "ColorId": 3,
                      "Percent": 0
                    }
                  }
                }
              }
            },
            "show": {
              "expr": {
                "Literal": {
                  "Value": "true"
                }
              }
            },
            "text": {
              "expr": {
                "Literal": {
                  "Value": "'Common Customer Complaints About Product Deliveries'"
                }
              }
            }
          }
        }
      ],
      "background": [
        {
          "properties": {
            "show": {
              "expr": {
                "Literal": {
                  "Value": "false"
                }
              }
            }
          }
        }
      ],
      "padding": [
        {
          "properties": {
            "left": {
              "expr": {
                "Literal": {
                  "Value": "0D"
                }
              }
            },
            "bottom": {
              "expr": {
                "Literal": {
                  "Value": "0D"
                }
              }
            },
            "right": {
              "expr": {
                "Literal": {
                  "Value": "0D"
                }
              }
            }
          }
        }
      ]
    },
    "drillFilterOtherVisuals": true
  }
}